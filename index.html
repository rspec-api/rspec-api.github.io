<!DOCTYPE html>
<html lang="en">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
  <title>An introduction to RSpec API</title>
  <link href="rspec-api.css" media="all" rel="stylesheet" type="text/css">
</head>
<body>
  <header>
    <img src="rspec-api-logo.png" alt="RSpec API">
    <p>When you write a web API, you make a promise to the world.<br />
       RSpec API helps you keep your promise.</p>
  </header>

  <article>
    <nav class="prev">
    </nav>
    <nav class="next">
      <a href="github.html" alt="The GitHub API example">Page 2 &rarr;</a>
    </nav>
    <h1>A basic example</h1>
    <p>You wrote a simple Concerts API that only accepts one request:</p>

    <pre class="request"><code>GET /concerts</code></pre>

    <p>and responds with this kind of data:</p>

    <pre><code>Status: 200 OK
Content-Type: application/json; charset=utf-8
</code></pre>

    <pre><code>[
  {
    <span class="string">"where"</span>: <span class="string">"Woodstock"</span>, <span class="string">"year"</span>: <span class="number">1969</span>,
    <span class="string">"performers"</span>: [
      {<span class="string">"name"</span>: <span class="string">"Jimi Hendrix"</span>, <span class="string">"website"</span>: <span class="string">"http://jimihendrix.com"</span>},
      {<span class="string">"name"</span>: <span class="string">"Janis Joplin"</span>, <span class="string">"website"</span>: <span class="string">"http://janisjoplin.com"</span>}
    ]
  },
  {
    <span class="string">"where"</span>: <span class="string">"Coachella"</span>, <span class="string">"year"</span>: <span class="number">2013</span>,
    <span class="string">"performers"</span>: [
      {<span class="string">"name"</span>: <span class="string">"Grizzly Bear"</span>, <span class="string">"website"</span>: <span class="number">nil</span>}
    ]
  }
]</code></pre>

    <p>Such a simple API is inherently making many <strong>promises</strong> to its consumers.<br />
       Even though the returned <em>data</em> might differ from call to call, the consumer should always <em>expect</em>:</p>

    <ul>
      <li>the status code to be <code>200</code></li>
      <li>the headers to include a <code>JSON content-type</code> indication</li>
      <li>the body to be an <code>array</code> of items, each representing a concert</li>
      <li>each concert to have a <code>where</code> attribute with a <code>string</code> value</li>
      <li>each concert to have a <code>year</code> attribute with an <code>integer</code> value</li>
      <li>each concert to have an <code>array</code> of performers</li>
      <li>each performer to have a <code>name</code> attribute with a <code>string</code> value</li>
      <li>each performer to have a <code>website</code> attribute with a <code>URL</code> or <code>nil</code> value</li>
    </ul>

    <h2>The power of RSpec API to the rescue</h2>

    <p>RSpec API provides a concise and readable way to express the set of promises listed above:</p>

    <pre><code>resource <span class="string">'Concerts'</span>, <span class="symbol">format:</span> <span class="symbol">:json</span> do
  has_attribute <span class="symbol">:where</span>, <span class="symbol">:string</span>
  has_attribute <span class="symbol">:year</span>, <span class="symbol">:integer</span>
  has_attribute <span class="symbol">:performers</span>, <span class="symbol">:array</span> do
    has_attribute <span class="symbol">:name</span>, <span class="symbol">:string</span>
    has_attribute <span class="symbol">:website</span>, <span class="symbol">:url</span>, <span class="symbol">can_be_nil:</span> <span class="constant">true</span>
  end

  get <span class="string">'/concerts'</span>, <span class="symbol">array:</span> <span class="constant">true</span> do
    request <span class="string">'Getting a list of concerts'</span> do
      respond_with <span class="symbol">:ok</span>
    end
  end
end</code></pre>

    <p>This snippet code is not only a meaningful <strong>documentation</strong> of the promises set by the API.<br />
       It is also a <strong>test</strong> that can be run by RSpec to ensure the promises are kept:</p>

    <pre class="request"><code>$ rspec spec/features/concerts_spec.rb</code></pre>

    <pre><code>Concerts
  GET /concerts
    by default
      responds with a status code that
        <span class="success">should be 200</span>
      responds with headers that
        <span class="success">should include 'Content-Type': 'application/json; charset=utf-8'</span>
      responds with a body that
        <span class="success">should be a JSON Array</span>
        <span class="success">should include the attribute "where" with a string value</span>
        <span class="success">should include the attribute "year" with an integer value</span>
        <span class="success">should include the attribute "performers" array, where each item</span>
          <span class="success">should include the attribute "name" with a string value</span>
          <span class="success">should include the attribute "website" with a URL or nil value</span></code></pre>

        <p>Now, go and run this code for yourself, then tell me what you think.
           All you need is RSpec API (<a href="https://github.com/rspec-api/rspec-api#a-basic-example">instructions</a>).</p>
  </article>

  <footer>
    <nav class="prev">
    </nav>
    <nav class="next">
      <a href="github.html" alt="The GitHub API example">Page 2 &rarr;</a>
    </nav>
    <h1>Want to know more?</h1>

    <p>RSpec API aims to make it easy to document and test <a href="http://www.vinaysahni.com/best-practices-for-a-pragmatic-restful-api">pragmatic RESTful web APIs</a>.</p>
    <p>It is still under development, and you can follow its progress by <a href="http://github.com/rspec-api/rspec-api">checking out the code on Github</a>.</p>
    <p>Other features not included in the basic examples above are:</p>

    <ul>
      <li>support for other HTTP verbs, e.g.: <code>POST /concerts</code></li>
      <li>support for more attribute types, such as <code>boolean</code></li>
      <li>support for nested routes, e.g.: <code>GET /locations/woodstock/concerts</code></li>
      <li>support for filters, e.g.: <code>GET /concerts?when=1969</code></li>
      <li>support for sorting, e.g.: <code>GET /concerts?sort=when</code></li>
      <li>support for pagination, e.g.: <code>GET /concerts?page=2</code></li>
      <li>support for JSONP callbacks, e.g.: <code>GET /concerts?callback=my_function</code></li>
    </ul>

    <p>If you are interested, star or fork the Github repository, or follow me! Thanks :)</p>
    <iframe src="http://ghbtns.com/github-btn.html?user=rspec-api&amp;repo=rspec-api&amp;type=watch" width="62" height="20"></iframe>
    <iframe src="http://ghbtns.com/github-btn.html?user=rspec-api&amp;repo=rspec-api&amp;type=fork" width="62" height="20"></iframe>
    <iframe src="http://ghbtns.com/github-btn.html?user=claudiob&amp;type=follow" width="132" height="20"></iframe>
  </article>
  <a href="https://github.com/rspec-api/rspec-api">
    <img class="ribbon" src="github-ribbon.png" alt="Fork RSpec API on GitHub">
  </a>
</body>
</html>